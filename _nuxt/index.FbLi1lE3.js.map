{"version":3,"file":"index.FbLi1lE3.js","sources":["../../../../pages/auth/index.vue"],"sourcesContent":["<template>\n  <div class=\"flex flex-col items-center gap-4\">\n    <form class=\"flex w-72 flex-col gap-2\">\n      <v-label label=\"E-mail\">\n        <v-input\n          v-model=\"form.email\"\n          type=\"email\"\n        />\n      </v-label>\n      <v-label label=\"Password\">\n        <v-input\n          v-model=\"form.password\"\n          :autofocus=\"Boolean(authStore.email)\"\n          type=\"password\"\n        />\n      </v-label>\n      <v-button\n        variant=\"primary\"\n        class=\"mt-2\"\n        :loading=\"isSubmitting\"\n        @click=\"submit\"\n      >\n        Login\n      </v-button>\n    </form>\n\n    <p class=\"text-sm\">Don't have an account? <NuxtLink to=\"/auth/sign-up\">Sign Up</NuxtLink></p>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { Payload } from \"core/types/api\"\n\ndefinePageMeta({\n  requiredRole: \"guest\",\n  layout: \"centered\",\n})\n\nconst authStore = useAuthStore()\nconst form = reactive<Payload<typeof login>>({\n  app_id: authStore.appID,\n  email: authStore.email,\n  password: \"\",\n  \"g-recaptcha-response\": \"\",\n})\n\nconst generateRecaptchaToken = useRecaptcha()\n\nconst isSubmitting = ref(false)\nasync function submit() {\n  isSubmitting.value = true\n\n  try {\n    form[\"g-recaptcha-response\"] = await generateRecaptchaToken()\n    const response = await login(form)\n\n    if (response.next_action === \"verify_2fa\") {\n      return navigateTo(\"/auth/2fa/verify/\" + response.ticket)\n    }\n\n    if (response.next_action === \"enable_2fa\") {\n      return navigateTo(\"/auth/2fa/enable/\" + response.ticket)\n    }\n\n    if (response.redirect_uri) {\n      return navigateTo(response.redirect_uri)\n    }\n  } finally {\n    isSubmitting.value = false\n  }\n}\n</script>\n"],"names":["authStore","useAuthStore","form","reactive","generateRecaptchaToken","useRecaptcha","isSubmitting","ref","submit","response","login","navigateTo"],"mappings":"2gBAsCA,MAAMA,EAAYC,IACZC,EAAOC,EAAgC,CAC3C,OAAQH,EAAU,MAClB,MAAOA,EAAU,MACjB,SAAU,GACV,uBAAwB,EAAA,CACzB,EAEKI,EAAyBC,IAEzBC,EAAeC,EAAI,EAAK,EAC9B,eAAeC,GAAS,CACtBF,EAAa,MAAQ,GAEjB,GAAA,CACGJ,EAAA,sBAAsB,EAAI,MAAME,IAC/B,MAAAK,EAAW,MAAMC,EAAMR,CAAI,EAE7B,GAAAO,EAAS,cAAgB,aACpB,OAAAE,EAAW,oBAAsBF,EAAS,MAAM,EAGrD,GAAAA,EAAS,cAAgB,aACpB,OAAAE,EAAW,oBAAsBF,EAAS,MAAM,EAGzD,GAAIA,EAAS,aACJ,OAAAE,EAAWF,EAAS,YAAY,CACzC,QACA,CACAH,EAAa,MAAQ,EACvB,CACF"}